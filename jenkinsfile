pipeline {
    agent { label 'worker2' }
    
    triggers { 
        githubPush()
    }

    stages {
        stage('pull code from git') {
            steps {
                git branch: 'devlop',
                    url: 'https://github.com/janakdasari-art/website-new.git'
                echo " pulled code "
            }
        }

        stage('building image and creating a container') {
            steps {
                sh '''
                sudo docker rmi janakdasari/project2 || true
                sudo docker build -t janakdasari/project2 .
                sudo docker push janakdasari/project2
                '''
            }
        }
    }
}
